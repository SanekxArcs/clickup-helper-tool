<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Templates Tab Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-8 bg-gray-100">
    <h1 class="text-2xl font-bold mb-4">Templates Tab Test</h1>
    
    <!-- Include the templates HTML directly for testing -->
    <div class="space-y-6">
        
        <!-- Section 1: Send to Review -->
        <div class="bg-white border border-gray-200 rounded-lg p-4">
            <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center justify-between">
                <span>ğŸ‘¥ Send to Review</span>
                <div class="flex gap-2">
                    <button id="clearReviewBtn" class="text-gray-500 hover:text-gray-700 text-sm px-2 py-1 rounded hover:bg-gray-100 transition-all duration-200" title="Clear to initial">ğŸ”„</button>
                    <button id="reviewSettingsBtn" class="text-gray-500 hover:text-gray-700 text-sm px-2 py-1 rounded hover:bg-gray-100 transition-all duration-200" title="Settings">âš™ï¸</button>
                </div>
            </h3>
            
            <div class="space-y-3">
                <div class="grid grid-cols-2 gap-2">
                    <div>
                        <label for="reviewer1Select" class="block text-sm font-medium text-gray-700 mb-1">Reviewer 1:</label>
                        <select id="reviewer1Select" class="w-full p-2 border-2 border-gray-200 rounded-md text-sm focus:outline-none focus:border-blue-500">
                            <option value="">Select Reviewer 1</option>
                            <option value="reviewer1">@reviewer1</option>
                            <option value="reviewer2">@reviewer2</option>
                            <option value="reviewer3">@reviewer3</option>
                            <option value="testuser1">@testuser1</option>
                            <option value="testuser2">@testuser2</option>
                        </select>
                    </div>
                    <div>
                        <label for="reviewer2Select" class="block text-sm font-medium text-gray-700 mb-1">Reviewer 2 (Optional):</label>
                        <select id="reviewer2Select" class="w-full p-2 border-2 border-gray-200 rounded-md text-sm focus:outline-none focus:border-blue-500">
                            <option value="">Select Reviewer 2</option>
                            <option value="reviewer1">@reviewer1</option>
                            <option value="reviewer2">@reviewer2</option>
                            <option value="reviewer3">@reviewer3</option>
                            <option value="testuser1">@testuser1</option>
                            <option value="testuser2">@testuser2</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label for="mergeRequestLink" class="block text-sm font-medium text-gray-700 mb-1">Merge Request Link:</label>
                    <input type="text" id="mergeRequestLink" placeholder="https://gitlab.com/project/merge_requests/123" class="w-full p-2 border-2 border-gray-200 rounded-md text-sm focus:outline-none focus:border-blue-500">
                </div>
                
                <div class="bg-gray-50 p-3 rounded-md">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Generated Message:</label>
                    <div id="reviewMessage" class="bg-white p-2 border rounded text-sm font-mono min-h-[60px] whitespace-pre-wrap">Select reviewers and add link to generate message</div>
                </div>
                
                <button id="copyReviewBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 disabled:bg-gray-300" disabled>
                    ğŸ“‹ Copy Review Message
                </button>
            </div>
        </div>

        <!-- Section 2: Send to QA -->
        <div class="bg-white border border-gray-200 rounded-lg p-4">
            <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                ğŸ§ª Send to QA
            </h3>
            
            <div class="space-y-3">
                <div>
                    <label for="testerSelect" class="block text-sm font-medium text-gray-700 mb-1">Tester:</label>
                    <select id="testerSelect" class="w-full p-2 border-2 border-gray-200 rounded-md text-sm focus:outline-none focus:border-blue-500">
                        <option value="">Select Tester</option>
                        <option value="tester">@tester</option>
                        <option value="qa1">@qa1</option>
                        <option value="qa2">@qa2</option>
                        <option value="testuser3">@testuser3</option>
                    </select>
                </div>
                
                <div>
                    <label for="branchName" class="block text-sm font-medium text-gray-700 mb-1">Branch Name:</label>
                    <input type="text" id="branchName" placeholder="feature/video_popup_size_fix_#WDEV-14120" class="w-full p-2 border-2 border-gray-200 rounded-md text-sm focus:outline-none focus:border-blue-500">
                </div>
                
                <div class="bg-gray-50 p-3 rounded-md">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Generated Message:</label>
                    <div id="qaMessage" class="bg-white p-2 border rounded text-sm font-mono min-h-[60px] whitespace-pre-wrap">Select tester and add branch name to generate message</div>
                </div>
                
                <button id="copyQaBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 disabled:bg-gray-300" disabled>
                    ğŸ“‹ Copy QA Message
                </button>
            </div>
        </div>

        <!-- Section 3: Comments Resolved -->
        <div class="bg-white border border-gray-200 rounded-lg p-4">
            <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                âœ… Comments Resolved
            </h3>
            
            <div class="space-y-3">
                <div>
                    <label for="resolvedReviewerSelect" class="block text-sm font-medium text-gray-700 mb-1">Reviewer:</label>
                    <select id="resolvedReviewerSelect" class="w-full p-2 border-2 border-gray-200 rounded-md text-sm focus:outline-none focus:border-blue-500">
                        <option value="">Select Reviewer</option>
                        <option value="reviewer1">@reviewer1</option>
                        <option value="reviewer2">@reviewer2</option>
                        <option value="reviewer3">@reviewer3</option>
                        <option value="testuser1">@testuser1</option>
                        <option value="testuser2">@testuser2</option>
                    </select>
                </div>
                
                <div>
                    <label for="resolvedLink" class="block text-sm font-medium text-gray-700 mb-1">GitLab Link:</label>
                    <input type="text" id="resolvedLink" placeholder="https://gitlab.com/project/merge_requests/123" class="w-full p-2 border-2 border-gray-200 rounded-md text-sm focus:outline-none focus:border-blue-500">
                </div>
                
                <div class="bg-gray-50 p-3 rounded-md">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Generated Message:</label>
                    <div id="resolvedMessage" class="bg-white p-2 border rounded text-sm font-mono min-h-[60px] whitespace-pre-wrap">Select reviewer and add link to generate message</div>
                </div>
                
                <button id="copyResolvedBtn" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 disabled:bg-gray-300" disabled>
                    ğŸ“‹ Copy Resolved Message
                </button>
            </div>
        </div>
        
    </div>

    <script>
        // Test implementation of templates functionality
        class TemplatesTest {
            constructor() {
                this.elements = {
                    // Review section
                    reviewer1Select: document.getElementById('reviewer1Select'),
                    reviewer2Select: document.getElementById('reviewer2Select'),
                    mergeRequestLink: document.getElementById('mergeRequestLink'),
                    reviewMessage: document.getElementById('reviewMessage'),
                    copyReviewBtn: document.getElementById('copyReviewBtn'),
                    clearReviewBtn: document.getElementById('clearReviewBtn'),
                    reviewSettingsBtn: document.getElementById('reviewSettingsBtn'),
                    
                    // QA section
                    testerSelect: document.getElementById('testerSelect'),
                    branchName: document.getElementById('branchName'),
                    qaMessage: document.getElementById('qaMessage'),
                    copyQaBtn: document.getElementById('copyQaBtn'),
                    
                    // Resolved section
                    resolvedReviewerSelect: document.getElementById('resolvedReviewerSelect'),
                    resolvedLink: document.getElementById('resolvedLink'),
                    resolvedMessage: document.getElementById('resolvedMessage'),
                    copyResolvedBtn: document.getElementById('copyResolvedBtn')
                };
                
                this.setupEventListeners();
                this.updateAll();
            }
            
            setupEventListeners() {
                // Review section
                this.elements.reviewer1Select.addEventListener('change', () => this.updateReviewMessage());
                this.elements.reviewer2Select.addEventListener('change', () => this.updateReviewMessage());
                this.elements.mergeRequestLink.addEventListener('input', () => this.updateReviewMessage());
                this.elements.copyReviewBtn.addEventListener('click', () => this.copyReviewMessage());
                this.elements.clearReviewBtn.addEventListener('click', () => this.clearReviewSection());
                this.elements.reviewSettingsBtn.addEventListener('click', () => this.openSettings());

                // QA section
                this.elements.testerSelect.addEventListener('change', () => this.updateQaMessage());
                this.elements.branchName.addEventListener('input', () => this.updateQaMessage());
                this.elements.copyQaBtn.addEventListener('click', () => this.copyQaMessage());

                // Resolved section
                this.elements.resolvedReviewerSelect.addEventListener('change', () => this.updateResolvedMessage());
                this.elements.resolvedLink.addEventListener('input', () => this.updateResolvedMessage());
                this.elements.copyResolvedBtn.addEventListener('click', () => this.copyResolvedMessage());
            }
            
            updateAll() {
                this.updateReviewMessage();
                this.updateQaMessage();
                this.updateResolvedMessage();
            }
            
            updateReviewMessage() {
                const reviewer1 = this.elements.reviewer1Select.value;
                const reviewer2 = this.elements.reviewer2Select.value;
                const link = this.elements.mergeRequestLink.value.trim();
                
                let message = '';
                let isValid = false;
                
                if (reviewer1) {
                    if (reviewer2) {
                        message = `Hey @${reviewer1} and @${reviewer2}. Please make a code review for my merge request ${link || '[link]'}.`;
                    } else {
                        message = `Hey @${reviewer1}. Please make a code review for my merge request ${link || '[link]'}.`;
                    }
                    isValid = true;
                } else {
                    message = 'Select reviewers and add link to generate message';
                }
                
                this.elements.reviewMessage.textContent = message;
                this.elements.copyReviewBtn.disabled = !isValid;
            }
            
            copyReviewMessage() {
                const message = this.elements.reviewMessage.textContent;
                navigator.clipboard.writeText(message).then(() => {
                    alert('Review message copied to clipboard!');
                });
            }
            
            updateQaMessage() {
                const tester = this.elements.testerSelect.value;
                const branch = this.elements.branchName.value.trim();
                
                let message = '';
                let isValid = false;
                
                if (tester && branch) {
                    message = `@${tester} task is completed, please check: "${branch}"`;
                    isValid = true;
                } else if (tester) {
                    message = `@${tester} task is completed, please check: "[branch name]"`;
                } else {
                    message = 'Select tester and add branch name to generate message';
                }
                
                this.elements.qaMessage.textContent = message;
                this.elements.copyQaBtn.disabled = !isValid;
            }
            
            copyQaMessage() {
                const message = this.elements.qaMessage.textContent;
                navigator.clipboard.writeText(message).then(() => {
                    alert('QA message copied to clipboard!');
                });
            }
            
            updateResolvedMessage() {
                const reviewer = this.elements.resolvedReviewerSelect.value;
                const link = this.elements.resolvedLink.value.trim();
                
                let message = '';
                let isValid = false;
                
                if (reviewer && link) {
                    message = `@${reviewer} comments in GitLab is resolved please check ${link}`;
                    isValid = true;
                } else if (reviewer) {
                    message = `@${reviewer} comments in GitLab is resolved please check [link]`;
                } else {
                    message = 'Select reviewer and add link to generate message';
                }
                
                this.elements.resolvedMessage.textContent = message;
                this.elements.copyResolvedBtn.disabled = !isValid;
            }
            
            copyResolvedMessage() {
                const message = this.elements.resolvedMessage.textContent;
                navigator.clipboard.writeText(message).then(() => {
                    alert('Resolved message copied to clipboard!');
                });
            }
            
            // Clear methods for test
            clearReviewSection() {
                this.elements.reviewer1Select.value = '';
                this.elements.reviewer2Select.value = '';
                this.elements.mergeRequestLink.value = '';
                this.updateReviewMessage();
            }
            
            openSettings() {
                alert('Settings modal would open here in the real extension!');
            }
        }
        
        // Initialize test
        new TemplatesTest();
    </script>
</body>
</html>
